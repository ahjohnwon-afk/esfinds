# 🎉 项目交付说明

## 项目名称
**沉香商家数据采集系统 (Tencent Maps Merchant Data Collection System)**

## 交付日期
2026年1月20日

---

## 📦 交付清单

### 1. 核心文件（6个）

| 文件名 | 说明 | 大小 |
|--------|------|------|
| `collect_tencent_maps.py` | 数据采集脚本（Python） | ~8.4 KB |
| `merchants.html` | 数据展示网页 | ~21 KB |
| `merchants_data.json` | 示例数据文件 | ~6 KB |
| `README_MERCHANTS.md` | 完整使用文档 | ~3 KB |
| `requirements.txt` | Python依赖列表 | <1 KB |
| `.gitignore` | Git忽略规则 | <1 KB |

### 2. 系统功能

#### ✅ 数据采集系统
- [x] 腾讯地图API集成
- [x] 5个API Key自动轮换（共10,000次配额）
- [x] 全国34个省级行政区覆盖
- [x] 自动保存与断点续传
- [x] 完整日志记录

#### ✅ 数据展示系统
- [x] 中国地图热力图可视化
- [x] 省份筛选功能
- [x] 关键词实时搜索
- [x] 分页表格展示
- [x] Excel一键导出
- [x] 响应式移动端适配

---

## 🚀 快速使用指南

### 第一步：安装环境
```bash
# 确保已安装 Python 3.7+
pip install -r requirements.txt
```

### 第二步：采集数据
```bash
# 运行采集脚本
python collect_tencent_maps.py

# 采集过程会：
# - 遍历全国34个省份
# - 每完成一个省份自动保存
# - 生成 merchants_data.json
# - 记录日志到 collection.log
```

### 第三步：查看结果
```bash
# 启动本地服务器
python -m http.server 8000

# 在浏览器中访问
# http://localhost:8000/merchants.html
```

---

## 🎯 系统特色功能

### 1. 智能API管理
```
API Key 1: XLJBZ-SNVKL-K6RPE-EIJQW-27QDE-QKBSP (2000次)
API Key 2: Y2WBZ-YPVKJ-EIDFK-DGFMF-2TGJZ-DEFJM (2000次)
API Key 3: 2BNBZ-WU5E4-QDIUI-K2L3P-RBK5S-HWFRL (2000次)
API Key 4: 3BHBZ-HJWCL-F63P5-EBF3P-JCWDE-5TB6P (2000次)
API Key 5: V4EBZ-TRW6Q-N245W-2JLIO-KVUZH-ZMBVS (2000次)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
总配额: 10,000 次请求
```

系统会自动：
- 监控每个Key的使用次数
- 配额用尽时自动切换到下一个Key
- 防止超出配额限制

### 2. 全国数据覆盖

采集范围包括：
- 4个直辖市：北京、天津、上海、重庆
- 23个省：广东、福建、浙江、江苏等
- 5个自治区：内蒙古、新疆、西藏、宁夏、广西
- 2个特别行政区：香港、澳门

### 3. 数据可视化

**地图功能：**
- 热力图展示各省份商家密度
- 颜色深浅表示商家数量多少
- 支持缩放、拖动、点击交互

**筛选功能：**
- 按省份快速筛选
- 关键词搜索（名称、地址、类别）
- 实时动态过滤

**导出功能：**
- 一键导出为Excel格式
- 自动生成文件名（含日期）
- 支持导出筛选后的数据

---

## 📊 示例数据说明

项目包含15条示例数据，分布如下：

| 省份 | 商家数量 | 代表性商家 |
|------|----------|------------|
| 广东省 | 5 | 天香阁、香满堂、禅香阁 |
| 福建省 | 3 | 福香堂、闽香阁 |
| 海南省 | 2 | 海南沉香堂、琼香苑 |
| 云南省 | 2 | 云香居、滇香雅集 |
| 北京市 | 1 | 京华沉香堂 |
| 上海市 | 1 | 申香斋 |
| 浙江省 | 1 | 江南沉香阁 |

---

## 🔧 自定义配置

### 修改搜索关键词

编辑 `collect_tencent_maps.py`：
```python
# 第18行
KEYWORD = "沉香"  # 改为您需要的关键词
```

### 修改API Keys

编辑 `collect_tencent_maps.py`：
```python
# 第11-17行
API_KEYS = [
    '您的Key1',
    '您的Key2',
    # ...
]
```

### 调整请求间隔

编辑 `collect_tencent_maps.py`：
```python
# 第125行 - 页面间隔
time.sleep(0.2)  # 改为更大的值以降低频率

# 第157行 - 省份间隔
time.sleep(0.5)  # 改为更大的值以降低频率
```

---

## 📝 采集日志示例

```
2026-01-20 10:00:00 - INFO - ============================================================
2026-01-20 10:00:00 - INFO - 开始全国采集 - 关键词: 沉香
2026-01-20 10:00:00 - INFO - 共 34 个省级行政区
2026-01-20 10:00:00 - INFO - 可用API Key数量: 5
2026-01-20 10:00:00 - INFO - 总配额: 10000 次请求
2026-01-20 10:00:00 - INFO - ============================================================
2026-01-20 10:00:01 - INFO - [1/34] 正在采集: 北京市
2026-01-20 10:00:01 - INFO - 开始采集区域: 北京市
2026-01-20 10:00:02 - INFO - API请求: 关键词=沉香, 区域=北京市, 页码=1, Key使用次数=1/2000
2026-01-20 10:00:03 - INFO - 区域 北京市 第1页采集 5 条数据
...
```

---

## ⚠️ 重要提示

### 1. 使用限制
- 遵守腾讯地图API服务条款
- 不要过度频繁请求
- 建议在非高峰期运行

### 2. 数据准确性
- 数据来源于腾讯地图API
- 仅供参考，以实际为准
- 建议定期更新数据

### 3. 浏览器要求
- 推荐使用Chrome、Firefox、Safari
- 确保JavaScript已启用
- 通过HTTP服务器访问（不要直接打开HTML）

### 4. 数据存储
- `merchants_data.json` 会被覆盖
- 建议采集完成后备份重要数据
- 日志文件会持续追加

---

## 🐛 常见问题解决

### Q1: 数据加载失败
**解决方案：**
```bash
# 1. 确保文件存在
ls -la merchants_data.json

# 2. 检查JSON格式
python -m json.tool merchants_data.json

# 3. 使用HTTP服务器
python -m http.server 8000
```

### Q2: API请求失败
**解决方案：**
- 检查网络连接
- 验证API Key是否有效
- 查看是否超出配额
- 检查 collection.log 日志

### Q3: 地图不显示
**原因：**
- 可能是网络问题
- CDN资源加载失败

**解决方案：**
- 刷新页面
- 检查浏览器控制台
- 数据表格仍可正常使用

### Q4: 如何中断采集
**操作：**
```bash
# 在运行的终端按
Ctrl + C

# 数据会自动保存
# 可以继续运行脚本恢复采集
```

---

## 📞 技术支持

如遇问题，请检查：
1. `collection.log` - 采集日志
2. 浏览器控制台 - 前端错误
3. Python错误信息 - 后端错误

---

## 📄 许可与版权

- 本项目仅供学习和研究使用
- 使用腾讯地图API需遵守其服务条款
- 商业使用请获取相应授权

---

## 🎓 技术文档

详细技术文档请参考：
- [README_MERCHANTS.md](README_MERCHANTS.md) - 完整使用说明

---

**交付完成时间**: 2026年1月20日  
**系统版本**: v1.0.0  
**开发者**: GitHub Copilot  
**项目仓库**: ahjohnwon-afk/esfinds

---

## ✅ 验收清单

请验收以下项目：

- [ ] 数据采集脚本运行正常
- [ ] 可以成功采集数据
- [ ] 网页可以正常打开
- [ ] 地图可视化功能正常
- [ ] 筛选功能工作正常
- [ ] 搜索功能工作正常
- [ ] Excel导出功能正常
- [ ] 文档说明清晰完整

**感谢使用本系统！祝您数据采集顺利！** 🎉
